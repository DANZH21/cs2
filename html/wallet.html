<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallet</title>
    <link rel="stylesheet" href="../css/main.css">
    <script src="https://cdn.jsdelivr.net/npm/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–æ—à–µ–ª—å–∫–∞ */
        .wallet-status {
            background: #1a1c2c;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }

        .wallet-address {
            background: #161825;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            word-break: break-all;
            font-family: monospace;
            cursor: pointer;
            position: relative;
        }

        .wallet-address:hover::after {
            content: 'Copy';
            position: absolute;
            right: 10px;
            background: #2962ff;
            padding: 2px 5px;
            border-radius: 4px;
            font-size: 12px;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }

        #connect-btn {
            background: #2962ff;
        }

        #disconnect-btn {
            background: #ff4757;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="notch">
        <h2 id="title">WALLET</h2>
        <div class="balance-container">
            <p id="balance-label">Balance:</p>
            <p id="balance">0</p>
        </div>
        <select id="language-selector" class="language-selector">
            <option value="en">üá∫üá∏</option>
            <option value="ru">üá∑üá∫</option>
        </select>
    </div>
    
    <div class="container">
        <button class="exit-button" onclick="window.location.href='main.html'">‚Æå Exit to Menu</button>
        
        <div class="wallet-status">
            <h3 id="wallet-status-title">Wallet not connected</h3>
            <div id="wallet-address" class="hidden wallet-address"></div>
        </div>

        <div class="action-buttons">
            <button id="connect-btn" class="button">Connect TON Wallet</button>
            <button id="disconnect-btn" class="button hidden">Disconnect</button>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TON Connect
            const connector = new TonConnect.TonConnect({
                manifestUrl: 'https://your-site.com/tonconnect-manifest.json'
            });

            // –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
            const texts = {
                en: {
                    title: "CS2 Case",
                    balanceLabel: "Balance:",
                    connected: "Wallet connected",
                    notConnected: "Wallet not connected",
                    connect: "Connect TON Wallet",
                    disconnect: "Disconnect",
                    copyAlert: "Address copied!"
                },
                ru: {
                    title: "CS2 Case",
                    balanceLabel: "–ë–∞–ª–∞–Ω—Å:",
                    connected: "–ö–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω",
                    notConnected: "–ö–æ—à–µ–ª–µ–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω",
                    connect: "–ü–æ–¥–∫–ª—é—á–∏—Ç—å TON –∫–æ—à–µ–ª–µ–∫",
                    disconnect: "–û—Ç–∫–ª—é—á–∏—Ç—å",
                    copyAlert: "–ê–¥—Ä–µ—Å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!"
                }
            };

            // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            let lang = localStorage.getItem('lang') || 'en';
            let balance = localStorage.getItem('balance') || "0";

            // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            const elements = {
                title: document.getElementById('title'),
                balanceLabel: document.getElementById('balance-label'),
                balance: document.getElementById('balance'),
                walletStatus: document.getElementById('wallet-status-title'),
                walletAddress: document.getElementById('wallet-address'),
                connectBtn: document.getElementById('connect-btn'),
                disconnectBtn: document.getElementById('disconnect-btn'),
                langSelector: document.getElementById('language-selector')
            };

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            function updateUI() {
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
                elements.balance.textContent = balance;
                
                // –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
                elements.title.textContent = texts[lang].title;
                elements.balanceLabel.textContent = texts[lang].balanceLabel;
                elements.connectBtn.textContent = texts[lang].connect;
                elements.disconnectBtn.textContent = texts[lang].disconnect;

                // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
                if (connector.connected) {
                    elements.walletStatus.textContent = texts[lang].connected;
                    elements.walletAddress.textContent = connector.account.address;
                    elements.walletAddress.classList.remove('hidden');
                    elements.disconnectBtn.classList.remove('hidden');
                    elements.connectBtn.classList.add('hidden');
                } else {
                    elements.walletStatus.textContent = texts[lang].notConnected;
                    elements.walletAddress.classList.add('hidden');
                    elements.disconnectBtn.classList.add('hidden');
                    elements.connectBtn.classList.remove('hidden');
                }
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            elements.connectBtn.addEventListener('click', async () => {
                const wallets = await connector.getWallets();
                if (wallets.length > 0) {
                    await connector.connect({ jsBridgeKey: wallets[0].jsBridgeKey });
                    connector.onStatusChange(updateUI);
                }
            });

            elements.disconnectBtn.addEventListener('click', async () => {
                await connector.disconnect();
                updateUI();
            });

            elements.langSelector.addEventListener('change', (e) => {
                lang = e.target.value;
                localStorage.setItem('lang', lang);
                updateUI();
            });

            elements.walletAddress.addEventListener('click', function() {
                if (connector.connected) {
                    navigator.clipboard.writeText(connector.account.address);
                    alert(texts[lang].copyAlert);
                }
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            elements.langSelector.value = lang;
            updateUI();
        });
    </script>
</body>
</html>